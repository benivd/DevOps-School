{"swagger":"2.0","info":{"description":"Use the AlgoSec Vulnerability REST APIs to manage remote integration with vulnerability scanners, including adding, getting, or deleting vulnerability data from ASMS, and searching vulnerability data.\n\nNote: You must be logged in to ASMS to execute these APIs. \nYou can also access this page from within ASMS. Click your username at the top-right and select API Documentation.","version":"A30.10","title":"AlgoSec Vulnerability REST API"},"basePath":"/ms-vulnerabilities","tags":[{"name":"data-collection-controller","description":"Data Collection Controller"},{"name":"import-vulnerability-controller","description":"Import Vulnerability Controller"},{"name":"settings-controller","description":"Settings Controller"},{"name":"vulnerability-controller","description":"Vulnerability Controller"},{"name":"vulnerability-kb-controller","description":"Vulnerability Kb Controller"}],"paths":{"/v1/api/data/collect":{"post":{"tags":["data-collection-controller"],"summary":"collectData","operationId":"collectDataUsingPOST","consumes":["application/json"],"produces":["*/*"],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/Status","originalRef":"Status"}}},"deprecated":false}},"/v1/api/data/collect/status":{"get":{"tags":["data-collection-controller"],"summary":"status","operationId":"statusUsingGET","produces":["*/*"],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/DataCollectionStatusDto","originalRef":"DataCollectionStatusDto"}}},"deprecated":false}},"/v1/api/import/delete":{"delete":{"tags":["import-vulnerability-controller"],"summary":"deleteImportedVulnerabilityData","operationId":"deleteImportedVulnerabilityDataUsingDELETE","produces":["*/*"],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/Status","originalRef":"Status"}}},"deprecated":false}},"/v1/api/import/hosts":{"post":{"tags":["import-vulnerability-controller"],"summary":"importVulnerabilityHosts","operationId":"importVulnerabilityHostsUsingPOST","consumes":["application/json"],"produces":["*/*"],"parameters":[{"in":"body","name":"vulnerabilityHosts","description":"vulnerabilityHosts","required":true,"schema":{"type":"array","items":{"$ref":"#/definitions/ImportHostRequest","originalRef":"ImportHostRequest"}}}],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/Status","originalRef":"Status"}}},"deprecated":false}},"/v1/api/import/kbs":{"post":{"tags":["import-vulnerability-controller"],"summary":"importVulnerabilityKb","operationId":"importVulnerabilityKbUsingPOST","consumes":["application/json"],"produces":["*/*"],"parameters":[{"in":"body","name":"request","description":"request","required":true,"schema":{"$ref":"#/definitions/ImportKbRequest","originalRef":"ImportKbRequest"}}],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/Status","originalRef":"Status"}}},"deprecated":false}},"/v1/api/kb/search":{"post":{"tags":["vulnerability-kb-controller"],"summary":"searchForKbByCveNameOrKbTitle","operationId":"searchForKbByCveNameOrKbTitleUsingPOST","consumes":["application/json"],"produces":["*/*"],"parameters":[{"name":"pageSize","in":"query","description":"pageSize","required":false,"type":"integer","format":"int32"},{"in":"body","name":"request","description":"request","required":true,"schema":{"$ref":"#/definitions/KbSearchRequest","originalRef":"KbSearchRequest"}}],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/KbSearchResult","originalRef":"KbSearchResult"}}},"deprecated":false}},"/v1/api/settings/":{"get":{"tags":["settings-controller"],"summary":"getSettings","operationId":"getSettingsUsingGET","produces":["*/*"],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/VulnerabilitySettings","originalRef":"VulnerabilitySettings"}}},"deprecated":false},"post":{"tags":["settings-controller"],"summary":"saveSettings","operationId":"saveSettingsUsingPOST","consumes":["application/json"],"produces":["*/*"],"parameters":[{"in":"body","name":"settings","description":"settings","required":true,"schema":{"$ref":"#/definitions/VulnerabilitySettings","originalRef":"VulnerabilitySettings"}}],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/Status","originalRef":"Status"}}},"deprecated":false}},"/v1/api/settings/supported_scanners":{"get":{"tags":["settings-controller"],"summary":"getSupportedScanners","operationId":"getSupportedScannersUsingGET","produces":["*/*"],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/SupportedScanners","originalRef":"SupportedScanners"}}},"deprecated":false}},"/v1/api/vulnerabilities/get":{"get":{"tags":["vulnerability-controller"],"summary":"getVulnerabilityByIds","operationId":"getVulnerabilityByIdsUsingGET","produces":["*/*"],"parameters":[{"name":"ids","in":"query","description":"ids","required":false,"type":"array","items":{"type":"integer","format":"int64"},"collectionFormat":"multi"},{"name":"pageNumber","in":"query","description":"pageNumber","required":false,"type":"integer","default":1,"format":"int32"}],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/Page첲ulnerability","originalRef":"Page첲ulnerability"}}},"deprecated":false}},"/v1/api/vulnerabilities/hosts":{"get":{"tags":["vulnerability-controller"],"summary":"searchForIpByKbIds","operationId":"searchForIpByKbIdsUsingGET","produces":["*/*"],"parameters":[{"name":"kbs","in":"query","description":"kbs","required":true,"type":"array","items":{"type":"integer","format":"int64"},"collectionFormat":"multi"}],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/IpResult","originalRef":"IpResult"}}},"deprecated":false}},"/v1/api/vulnerabilities/search":{"post":{"tags":["vulnerability-controller"],"summary":"search","operationId":"searchUsingPOST","consumes":["application/json"],"produces":["*/*"],"parameters":[{"in":"body","name":"request","description":"request","required":true,"schema":{"$ref":"#/definitions/VulnerabilitySearchRequest","originalRef":"VulnerabilitySearchRequest"}}],"responses":{"200":{"description":"OK","schema":{"type":"object"}}},"deprecated":false}},"/v1/api/vulnerabilities/searchBulk":{"post":{"tags":["vulnerability-controller"],"summary":"searchBulk","operationId":"searchBulkUsingPOST","consumes":["application/json"],"produces":["*/*"],"parameters":[{"in":"body","name":"request","description":"request","required":true,"schema":{"$ref":"#/definitions/BulkSearchRequest","originalRef":"BulkSearchRequest"}}],"responses":{"200":{"description":"OK","schema":{"type":"object"}}},"deprecated":false}}},"definitions":{"BulkSearchRequest":{"type":"object","properties":{"bulkSearchMap":{"type":"object","additionalProperties":{"$ref":"#/definitions/VulnerabilitySearchRequest","originalRef":"VulnerabilitySearchRequest"}}},"title":"BulkSearchRequest"},"Calendar":{"type":"object","properties":{"calendarType":{"type":"string"},"firstDayOfWeek":{"type":"integer","format":"int32"},"lenient":{"type":"boolean"},"minimalDaysInFirstWeek":{"type":"integer","format":"int32"},"time":{"type":"string","format":"date-time"},"timeInMillis":{"type":"integer","format":"int64"},"timeZone":{"$ref":"#/definitions/TimeZone","originalRef":"TimeZone"},"weekDateSupported":{"type":"boolean"},"weekYear":{"type":"integer","format":"int32"},"weeksInWeekYear":{"type":"integer","format":"int32"}},"title":"Calendar"},"DataCollectionStatusDto":{"type":"object","properties":{"lastCollectSuccess":{"type":"boolean"},"lastCollectTimestamp":{"type":"integer","format":"int64"},"lastSuccessCollectTimestamp":{"type":"integer","format":"int64"},"running":{"type":"boolean"}},"title":"DataCollectionStatusDto"},"ImportHostRequest":{"type":"object","properties":{"date":{"type":"integer","format":"int64"},"ip":{"type":"string"},"kbId":{"type":"string"}},"title":"ImportHostRequest"},"ImportKbItemRequest":{"type":"object","properties":{"cves":{"type":"array","items":{"type":"string"}},"cvssScore":{"type":"number","format":"float"},"description":{"type":"string"},"kbId":{"type":"string"},"summary":{"type":"string"}},"title":"ImportKbItemRequest"},"ImportKbRequest":{"type":"object","properties":{"deleteOldImportedData":{"type":"boolean"},"vulnerabilityKbs":{"type":"array","items":{"$ref":"#/definitions/ImportKbItemRequest","originalRef":"ImportKbItemRequest"}}},"title":"ImportKbRequest"},"IpResult":{"type":"object","properties":{"ips":{"type":"array","items":{"type":"string"}}},"title":"IpResult"},"KbSearchRequest":{"type":"object","properties":{"searchText":{"type":"string"}},"title":"KbSearchRequest"},"KbSearchResult":{"type":"object","properties":{"content":{"type":"object","additionalProperties":{"type":"array","items":{"type":"integer","format":"int64"}}}},"title":"KbSearchResult"},"Pageable":{"type":"object","properties":{"offset":{"type":"integer","format":"int64"},"pageNumber":{"type":"integer","format":"int32"},"pageSize":{"type":"integer","format":"int32"},"paged":{"type":"boolean"},"sort":{"$ref":"#/definitions/Sort","originalRef":"Sort"},"unpaged":{"type":"boolean"}},"title":"Pageable"},"Page첲ulnerability":{"type":"object","properties":{"content":{"type":"array","items":{"$ref":"#/definitions/Vulnerability","originalRef":"Vulnerability"}},"empty":{"type":"boolean"},"first":{"type":"boolean"},"last":{"type":"boolean"},"number":{"type":"integer","format":"int32"},"numberOfElements":{"type":"integer","format":"int32"},"pageable":{"$ref":"#/definitions/Pageable","originalRef":"Pageable"},"size":{"type":"integer","format":"int32"},"sort":{"$ref":"#/definitions/Sort","originalRef":"Sort"},"totalElements":{"type":"integer","format":"int64"},"totalPages":{"type":"integer","format":"int32"}},"title":"Page첲ulnerability"},"ScannerMetaData":{"type":"object","properties":{"display":{"type":"string"},"name":{"type":"string"}},"title":"ScannerMetaData"},"Sort":{"type":"object","properties":{"empty":{"type":"boolean"},"sorted":{"type":"boolean"},"unsorted":{"type":"boolean"}},"title":"Sort"},"Status":{"type":"object","properties":{"data":{"type":"object"},"error":{"type":"string"},"msg":{"type":"string"},"status":{"type":"string"},"success":{"type":"boolean"},"type":{"type":"string"}},"title":"Status"},"SupportedScanners":{"type":"object","properties":{"supportedScanners":{"type":"array","items":{"$ref":"#/definitions/ScannerMetaData","originalRef":"ScannerMetaData"}}},"title":"SupportedScanners"},"TimeZone":{"type":"object","properties":{"displayName":{"type":"string"},"dstsavings":{"type":"integer","format":"int32"},"id":{"type":"string"},"rawOffset":{"type":"integer","format":"int32"}},"title":"TimeZone"},"Vulnerability":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"kbList":{"type":"array","items":{"$ref":"#/definitions/VulnerabilityKb","originalRef":"VulnerabilityKb"}},"scanId":{"type":"string"},"scanTimestamp":{"$ref":"#/definitions/Calendar","originalRef":"Calendar"}},"title":"Vulnerability"},"VulnerabilityCVE":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"name":{"type":"string"}},"title":"VulnerabilityCVE"},"VulnerabilityGeneralSettingsDto":{"type":"object","properties":{"day":{"type":"string"},"maxRange":{"type":"integer","format":"int32"},"period":{"type":"string"},"scheduleEnabled":{"type":"boolean"},"timeHour":{"type":"string"},"timeMinute":{"type":"string"}},"title":"VulnerabilityGeneralSettingsDto"},"VulnerabilityKb":{"type":"object","properties":{"cvelist":{"type":"array","items":{"$ref":"#/definitions/VulnerabilityCVE","originalRef":"VulnerabilityCVE"}},"cvssScore":{"type":"number","format":"float"},"description":{"type":"string"},"id":{"type":"integer","format":"int64"},"kbId":{"type":"string"},"kbLink":{"type":"string"},"severityLevel":{"type":"string","enum":["NONE","VERY_HIGH","HIGH","MEDIUM","LOW","NA"]},"title":{"type":"string"}},"title":"VulnerabilityKb"},"VulnerabilityScannerDto":{"type":"object","properties":{"hostname":{"type":"string"},"password":{"type":"string"},"type":{"type":"string","enum":["RAPID_7V3","QUALYS","NESSUS_6","NESSUS_MANAGER","SECURITY_CENTER_5","FILE_SCANNER"]},"username":{"type":"string"}},"title":"VulnerabilityScannerDto"},"VulnerabilitySearchRequest":{"type":"object","properties":{"fullResponse":{"type":"boolean"},"ips":{"type":"array","items":{"type":"string"}}},"title":"VulnerabilitySearchRequest"},"VulnerabilitySettings":{"type":"object","properties":{"generalSettings":{"$ref":"#/definitions/VulnerabilityGeneralSettingsDto","originalRef":"VulnerabilityGeneralSettingsDto"},"hasVulnerabilities":{"type":"boolean"},"scanners":{"type":"array","items":{"$ref":"#/definitions/VulnerabilityScannerDto","originalRef":"VulnerabilityScannerDto"}}},"title":"VulnerabilitySettings"}}}